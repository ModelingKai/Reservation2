# 8. Getの時はクエリオブジェクト経由で参照する

Date: 2021-01-24

## Status

Accepted

## Context

Presentation（Controller）で、予約された内容を取得して、クライアントに返すAPIを作りたかったが、

ユースケースの戻り値をドメインオブジェクト（予約）に最初はしようとしたが、ドメインオブジェクトのプロパティはprivateにしている為、

クライアントに値を返すことができない。

かといって、ドメインオブジェクトのプロパティをpublicにするのは、その値を気軽に悪用される可能性があるので避けたい。
Don't Ask Tellの考え方。

### ここでの悪用とは

- Presentationなどの、Domain層の外の人たちが、予約.予約Id.Valueみたいなアクセスが出来たとして、それを元にif文などの条件判断とかをするようなロジックがDomainの外で書ける可能性が多くなる。
    - それはすなわち、ドメインロジックの流出に繋がってしまうので、避けたい。

## Decision

- CQSの導入
    - Getなどの参照系のユースケースでは、クエリオブジェクト経由で参照する
- クエリオブジェクトは、同じドメインオブジェクトのネームスペース内で作成
    - 予約ネームスペース内に、予約QueryModelを作成
- ドメインオブジェクトに、QueryModelの変換メソッドを生やす

## Consequences

- Presentationは、参照系のユースケースからクエリオブジェクトを取得し、オブジェクトそのものをクライアントに返すようになった


